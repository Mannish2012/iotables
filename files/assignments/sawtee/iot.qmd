---
title: "Nepal Input Output Tables"
format: 
  pdf:
    extra_dependencies:
      - soul
      - tikz
      - amsmath
editor: visual
execute: 
  echo: false
  warning: false
---

## Nepal Input Output Tables

```{r init}
library(dplyr)
library(ggplot2)
library(purrr)
library(readxl)

```

```{r}
source("coef_matrices.R")
```

## Linkages

### Backward linkages: 

**backward linkage** is a measure of the reliance of an industry on *upstream* industries for its intermediate inputs. 

### Calculating backward linkages: 

*Direct backward linkage* of a sector *j* is given by the sum of elements in the *jth* column of the technical coefficients matrix A. 

$\sum_{i=1}^{n} a_{ij}$ = $\begin{bmatrix} a_{11} & .. & a_{1n}\\ .. & .. & ..\\ a_{n1} & .. & a_{nn} \end{bmatrix}$

Here, $a_{ij} = z_{ij}/x_j$ where $z_{ij}$ is the intermediate sales from sector $i$ to sector $j$ and $x_j$ is the *gross output* of sector $j$. 

### Measuring direct backward linkage

Since $\mathbf{x} = C\mathbf{x} + \mathbf{d}$, we can rewrite the matrix equation as

$x_1 = c_{11}x_1 + c_{12}x_2 + ... + c_{1j}x_j + ... + c_{1n}x_n + d_1$\newline
$x_2 = c_{21}x_1 + c_{22}x_2 + ... + c_{2j}x_j + ... + c_{2n}x_n + d_2$\newline
$.$\newline
$.$\newline
$.$\newline
$x_n = c_{n1}x_1 + c_{n2}x_2 + ... + c_{nj}x_j + ... + c_{nn}x_n + d_n$

So, for any industry *j*, the direct backward linkage is the sum of the elements of column *j* in the associated technical coefficients matrix $C$. 

### Normalized backward linkages

**Normalized direct backward linkage** is obtained by dividing sector *j*'s direct backward linkages by the mean of all direct backward linkages. 
**Normalized total backward linkage** is obtained by dividing sector *j*'s total backward linkages by the mean of all total backward linkages. 

\newpage

### Forward linkages

**Forward linkage** is a measure of the reliance of *downstream* industries for a particular industries outputs (which are intermediate inputs for those industries).

As in the case of forward linkages, we can calculate both direct and total forward linkages. **Direct forward linkage** of sector *i* is given by the *row sums of the output coefficients matrix B* for that sector.


$\sum_{i=1}^{n} l_{ij}$ = $\begin{bmatrix} l_{11} & .. & l_{1n}\\ .. & .. & ..\\ l_{n1} & .. & l_{nn} \end{bmatrix}$

Given $\mathbf{x} = L\mathbf{f}$, we can rewrite the matrix equation as

$x_1 = l_{11}f_1 + l_{12}f_2 + ... + l_{1j}f_j + ... + l_{1n}f_n$\newline
$x_2 = l_{21}f_1 + l_{22}f_2 + ... + l_{2j}f_j + ... + l_{2n}f_n$\newline
$.$\newline
$.$\newline
$.$\newline
$x_n = l_{n1}f_1 + l_{n2}f_2 + ... + l_{nj}f_j + ... + l_{nn}f_n$


**Total forward linkage** captures both direct and indirect effects and is given by the *row sums of the output inverse matrix* $G = (I-B)^{-1}$ where $I$ is the $35 X 35$ identity matrix and $B$ is the output coefficients matrix.

**Normalized direct forward linkage** is obtained by dividing sector *i*'s direct forward linkages by the mean of all direct forward linkages. 
**Normalized total forward linkage** is obtained by dividing sector *i*'s total forward linkages by the mean of all total forward linkages. 

```{r}
source("linkages.R")

```


```{r}
linkage(2012,"direct","forward")
```

